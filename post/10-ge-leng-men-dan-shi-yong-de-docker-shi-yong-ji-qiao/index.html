
<!DOCTYPE html>
<html>
  <head>
    
<meta charset="utf-8" >

<title>10个冷门但实用的Docker实用技巧 | Gridea</title>
<meta name="description" content="温故而知新">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://victoryfan.github.io/guagua//favicon.ico?v=1604992897862">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://victoryfan.github.io/guagua//styles/main.css">



<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>



  </head>
  <body>
    <div id="app" class="main">
      <div class="site-header-container">
  <div class="site-header">
    <div class="left">
      <a href="https://victoryfan.github.io/guagua/">
        <img class="avatar" src="https://victoryfan.github.io/guagua//images/avatar.png?v=1604992897862" alt="" width="32px" height="32px">
      </a>
      <a href="https://victoryfan.github.io/guagua/">
        <h1 class="site-title">Gridea</h1>
      </a>
    </div>
    <div class="right">
      <transition name="fade">
        <i class="icon" :class="{ 'icon-close-outline': menuVisible, 'icon-menu-outline': !menuVisible }" @click="menuVisible = !menuVisible"></i>
      </transition>
    </div>
  </div>
</div>

<transition name="fade">
  <div class="menu-container" style="display: none;" v-show="menuVisible">
    <div class="menu-list">
      
        
          <a href="/" class="menu purple-link">
            首页
          </a>
        
      
        
          <a href="/archives" class="menu purple-link">
            归档
          </a>
        
      
        
          <a href="/tags" class="menu purple-link">
            标签
          </a>
        
      
        
          <a href="/post/about" class="menu purple-link">
            关于
          </a>
        
      
    </div>
  </div>
</transition>


      <div class="content-container">
        <div class="post-detail">
          
          <h2 class="post-title">10个冷门但实用的Docker实用技巧</h2>
          <div class="post-info post-detail-info">
            <span><i class="icon-calendar-outline"></i> 2020-11-10</span>
            
              <span>
                <i class="icon-pricetags-outline"></i>
                
                  <a href="https://victoryfan.github.io/guagua/tag/E8PhORe-3/">
                    Docker
                    
                  </a>
                
              </span>
            
          </div>
          <div class="post-content">
            <h3 id="1-docker-top">1、docker top</h3>
<p>这个命令用来查看一个容器里面的进程信息，如：</p>
<pre><code>docker top int
UID   PID    PPID   C    STIME  TTY   TIME         CMD
root  21119  24419  99   Nov09   ?    1-00:21:33   /usr/local/bin/node ./src/client/host/startNode.js
root  24419  24390   0   Nov09   ?    00:00:00     node ./src/tool/startDPeer.js --main --rpchost 0.0.0.0 --rpcport 7001
</code></pre>
<h3 id="2-docker-load-docker-save">2、docker load &amp;&amp; docker save</h3>
<p>一般使用这两个命令去下载打包Kubernetes的镜像，因为国内的网速有些慢。</p>
<p>docker save 可以把一个镜像保存到 tar 文件中，如：</p>
<pre><code>root@c02_walletnode_server_test_v_hk:~# docker save node:8.12.0 &gt;node-8.12.0.tar
#同时 docker load 可以把镜像从 tar 文件导入到 docker 中
root@c02_walletnode_server_test_v_hk:~# docker load &lt; node-8.12.0.tar
</code></pre>
<p>###3、docker search<br>
这个命令可以在命令行中方便的搜索 DockerHub 中的镜像，比如：</p>
<pre><code>root@c02_walletnode_server_test_v_hk:~# docker search nginx
NAME                               DESCRIPTION                                     STARS               OFFICIAL            AUTOMATED
nginx                              Official build of Nginx.                        13988               [OK]
jwilder/nginx-proxy                Automated Nginx reverse proxy for docker con…   1908                                    [OK]
richarvey/nginx-php-fpm            Container running Nginx + PHP-FPM capable of…   791                                     [OK]
linuxserver/nginx                  An Nginx container, brought to you by LinuxS…   128
jc21/nginx-proxy-manager           Docker container for managing Nginx proxy ho…   109
tiangolo/nginx-rtmp                Docker image with Nginx using the nginx-rtmp…   103                                     [OK]
bitnami/nginx                      Bitnami nginx Docker Image                      90                                      [OK]
alfg/nginx-rtmp                    NGINX, nginx-rtmp-module and FFmpeg from sou…   80                                      [OK]
jlesage/nginx-proxy-manager        Docker container for Nginx Proxy Manager        67                                      [OK]
nginxdemos/hello                   NGINX webserver that serves a simple page co…   63                                      [OK]
nginx/nginx-ingress                NGINX Ingress Controller for Kubernetes         45
privatebin/nginx-fpm-alpine        PrivateBin running on an Nginx, php-fpm &amp; Al…   40                                      [OK]
nginxinc/nginx-unprivileged        Unprivileged NGINX Dockerfiles                  19
schmunk42/nginx-redirect           A very simple container to redirect HTTP tra…   19                                      [OK]
nginx/nginx-prometheus-exporter    NGINX Prometheus Exporter                       15
centos/nginx-112-centos7           Platform for running nginx 1.12 or building …   15
staticfloat/nginx-certbot          Opinionated setup for automatic TLS certs lo…   14                                      [OK]
raulr/nginx-wordpress              Nginx front-end for the official wordpress:f…   13                                      [OK]
centos/nginx-18-centos7            Platform for running nginx 1.8 or building n…   13
flashspys/nginx-static             Super Lightweight Nginx Image                   7                                       [OK]
bitwarden/nginx                    The Bitwarden nginx web server acting as a r…   7
mailu/nginx                        Mailu nginx frontend                            7                                       [OK]
bitnami/nginx-ingress-controller   Bitnami Docker Image for NGINX Ingress Contr…   6                                       [OK]
ansibleplaybookbundle/nginx-apb    An APB to deploy NGINX                          1                                       [OK]
wodby/nginx                        Generic nginx                                   1                                       [OK]
</code></pre>
<h3 id="4-docker-events">4、docker events</h3>
<p>获取 docker 的各种事件信息，比如创建了一个容器什么的。</p>
<pre><code>docker events
2020-07-28T21:28:46.000403018+08:00 image load sha256:432bf69f0427b52cad10897342eaf23521b7d973566354118e9a59c4d31b5fae (name=sha256:432bf69f0427b52cad10897342eaf23521b7d973566354118e9a59c4d31b5fae)
</code></pre>
<h3 id="5-docker-update">5、docker update</h3>
<p>当 docker run 了之后却发现里面有一些参数并不是你想要的状态比如你设置的 nginx 容器 cpu 或内存大小，这个时候你就可以使用 docker update 去修改这些参数。</p>
<pre><code>docker update nginx --cpus 2
</code></pre>
<h3 id="6-docker-history">6、docker history</h3>
<p>当你修改了一个镜像，但是忘记了每一层的修改命令，或者你想查看一个镜像是怎么构建的时候就可以使用这个命令，比如：</p>
<pre><code>root@c02_walletnode_server_test_v_hk:~# docker history int
IMAGE               CREATED             CREATED BY                                      SIZE                COMMENT
1456ce379a71        38 hours ago        /bin/sh -c #(nop)  CMD [&quot;node&quot; &quot;./src/tool/s…   0B
286deaa63603        38 hours ago        /bin/sh -c #(nop)  EXPOSE 7001                  0B
037b119e344c        38 hours ago        /bin/sh -c #(nop) WORKDIR /home/nodeapp/int     0B
f690f91a1762        38 hours ago        /bin/sh -c cd /home/nodeapp/int &amp;&amp; npm insta…   39.3MB
6f8a531c291d        38 hours ago        /bin/sh -c mkdir -p /home/nodeapp/ &amp;&amp; cd /ho…   5.05MB
4e06a9fee726        38 hours ago        /bin/sh -c apt-get install git                  0B
ce426dead114        24 months ago       /bin/sh -c #(nop)  CMD [&quot;node&quot;]                 0B
&lt;missing&gt;           24 months ago       /bin/sh -c set -ex   &amp;&amp; for key in     6A010…   4.5MB
&lt;missing&gt;           24 months ago       /bin/sh -c #(nop)  ENV YARN_VERSION=1.9.4       0B
&lt;missing&gt;           24 months ago       /bin/sh -c ARCH= &amp;&amp; dpkgArch=&quot;$(dpkg --print…   53.8MB
&lt;missing&gt;           24 months ago       /bin/sh -c #(nop)  ENV NODE_VERSION=8.12.0      0B
&lt;missing&gt;           24 months ago       /bin/sh -c set -ex   &amp;&amp; for key in     94AE3…   141kB
&lt;missing&gt;           24 months ago       /bin/sh -c groupadd --gid 1000 node   &amp;&amp; use…   335kB
&lt;missing&gt;           24 months ago       /bin/sh -c set -ex;  apt-get update;  apt-ge…   320MB
&lt;missing&gt;           24 months ago       /bin/sh -c apt-get update &amp;&amp; apt-get install…   123MB
&lt;missing&gt;           24 months ago       /bin/sh -c set -ex;  if ! command -v gpg &gt; /…   0B
&lt;missing&gt;           24 months ago       /bin/sh -c apt-get update &amp;&amp; apt-get install…   41.1MB
&lt;missing&gt;           24 months ago       /bin/sh -c #(nop)  CMD [&quot;bash&quot;]                 0B
&lt;missing&gt;           24 months ago       /bin/sh -c #(nop) ADD file:0b25d0012989e20b9…   127MB
</code></pre>
<p>###7、 docker wait<br>
这个命令可以查看容器的退出状态，比如：</p>
<pre><code>root@c02_walletnode_server_test_v_hk:~# docker wait int
137
</code></pre>
<h3 id="8-docker-pause-docker-unpause">8、docker pause &amp;&amp; docker unpause</h3>
<p>当你运行了一个容器但是想要暂停它运行的时候，就可以使用这个命令。</p>
<pre><code>docker pause int
docker unpause int
</code></pre>
<h3 id="9-docker-diff">9、docker diff</h3>
<p>当你运行了一个容器，但是你不知道容器里修改了哪一些文件的时候可以使用这个命令，比如：</p>
<pre><code>root@c02_walletnode_server_test_v_hk:~# docker diff int
C /home
C /home/nodeapp
C /home/nodeapp/int
C /home/nodeapp/int/data
C /home/nodeapp/int/data/intchain
A /home/nodeapp/int/data/intchain/.options.json
A /home/nodeapp/int/data/intchain/peerData
C /root
A /root/.bash_history
</code></pre>
<h3 id="10-docker-stats">10、docker stats</h3>
<p>这个是 docker 内置的监控命令，当你想查看当前主机下所有容器占用内存和 cpu 的情况的时候就可以使用这个命令。</p>
<pre><code>root@c02_walletnode_server_test_v_hk:~# docker stats

CONTAINER ID        NAME                           CPU %               MEM USAGE / LIMIT     MEM %               NET I/O             BLOCK I/O           PIDS
f278b86b9169        mocknet_stacks-node-follower   22.79%              65.09MiB / 62.91GiB   0.10%               6.73MB / 12MB       0B / 0B             4
25c4f5503d7d        mocknet_explorer               0.14%               68.5MiB / 62.91GiB    0.11%               1.52kB / 0B         0B / 0B             18
20fe840c19a5        mocknet_stacks-node-api        0.39%               98.35MiB / 62.91GiB   0.15%               14.7MB / 15.2MB     0B / 0B             22
d6e08253c502        mocknet_postgres               0.63%               21.96MiB / 62.91GiB   0.03%               12.2MB / 4.82MB     0B / 0B             8
bbc9c57ce680        mocknet_stacks-node-miner      1.10%               62.75MiB / 62.91GiB   0.10%               3.49MB / 3.72MB     0B / 0B             2
ebb3f75adc59        int                            91.52%              159.5MiB / 62.91GiB   0.25%               64.5MB / 2.78MB     0B / 0B             16
</code></pre>

          </div>
        </div>

        
          <div class="next-post">
            <a class="purple-link" href="https://victoryfan.github.io/guagua/post/shu-ju-jie-gou-yu-suan-fa/">
              <h3 class="post-title">
                下一篇：数据结构与算法
              </h3>
            </a>
          </div>
          
      </div>

      

      <div class="site-footer">
  <div class="slogan">温故而知新</div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://victoryfan.github.io/guagua//atom.xml" target="_blank">RSS</a>
</div>


    </div>
    <script type="application/javascript">

hljs.initHighlightingOnLoad()

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>




  </body>
</html>
